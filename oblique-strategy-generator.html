<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Oblique Strategy Generator</title>

<style>
  body {
    background: #111;
    color: #eee;
    font-family: system-ui, sans-serif;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100vh;
    margin: 0;
  }

  .scene {
    width: 320px;
    height: 200px;
    perspective: 1000px;
    margin-bottom: 24px;
  }

  .card {
    width: 100%;
    height: 100%;
    position: relative;
    transform-style: preserve-3d;
    transition: transform 0.8s cubic-bezier(.4,.2,.2,1);
  }

  .card.flipped {
    transform: rotateY(180deg);
  }

  .card-face {
    position: absolute;
    width: 100%;
    height: 100%;
    border-radius: 12px;
    backface-visibility: hidden;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 24px;
    box-sizing: border-box;
    text-align: center;
    font-size: 1.1rem;
    line-height: 1.4;
  }

  .card-back {
    background: linear-gradient(135deg, #333, #000);
    border: 1px solid #666;
    font-weight: bold;
    letter-spacing: 2px;
  }

  .card-front {
    background: #f5f5f5;
    color: #111;
    transform: rotateY(180deg);
    border: 1px solid #ccc;
  }

  .cursor {
    display: inline-block;
    width: 0.6ch;
    animation: blink 1s steps(1) infinite;
  }

  @keyframes blink {
    50% { opacity: 0; }
  }

  button {
    background: #fff;
    color: #111;
    border: none;
    padding: 12px 24px;
    font-size: 1rem;
    border-radius: 6px;
    cursor: pointer;
  }

  button:hover {
    background: #ddd;
  }
</style>
</head>
<body>

<div class="scene">
  <div class="card" id="card">
    <div class="card-face card-back">
      O B L I Q U E<br/>S T R A T E G I E S
    </div>
    <div class="card-face card-front">
      <span id="strategyText"></span><span class="cursor">â–Œ</span>
    </div>
  </div>
</div>

<button id="rollBtn">Roll</button>

<script>
  const STRATEGY_URL =
    "https://pxslgames.github.io/my-random-website-stuff/strategies.json";

  let strategies = [];

  const card = document.getElementById("card");
  const strategyText = document.getElementById("strategyText");
  const rollBtn = document.getElementById("rollBtn");

  let isFrontVisible = false;
  let typingTimeout;

  async function loadStrategies() {
    try {
      const response = await fetch(STRATEGY_URL);
      const data = await response.json();

      strategies = Array.isArray(data) ? data : data.strategies;

      if (!Array.isArray(strategies) || strategies.length === 0) {
        throw new Error("No strategies found");
      }
    } catch (err) {
      console.error("Failed to load strategies:", err);
      strategies = ["Failed to load strategies"];
    }
  }

  function getRandomStrategy() {
    return strategies[Math.floor(Math.random() * strategies.length)];
  }

  function typeText(text, speed = 35) {
    strategyText.textContent = "";
    let i = 0;

    function type() {
      if (i < text.length) {
        strategyText.textContent += text[i];
        i++;
        typingTimeout = setTimeout(type, speed);
      }
    }

    type();
  }

  rollBtn.addEventListener("click", () => {
    if (strategies.length === 0) return;

    clearTimeout(typingTimeout);

    if (isFrontVisible) {
      card.classList.remove("flipped");

      setTimeout(() => {
        const strategy = getRandomStrategy();
        strategyText.textContent = "";
        card.classList.add("flipped");

        setTimeout(() => {
          typeText(strategy);
        }, 500);
      }, 400);
    } else {
      const strategy = getRandomStrategy();
      card.classList.add("flipped");

      setTimeout(() => {
        typeText(strategy);
      }, 500);
    }

    isFrontVisible = true;
  });

  loadStrategies();
</script>

</body>
</html>
